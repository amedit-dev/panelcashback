$((function() {
    "use strict";
    var e = $(".datatables-basic");

    var queryString = window.location.search;
    var urlParams = new URLSearchParams(queryString);
    var date = urlParams.get('date')


   var path  = window.location.pathname;
   // console.log(path + '/api?date='+ date );

     var  n = "addtransazioni",
         path = 'transazioni',

         edit = path+'/edit/',
         trash = path+'/delete/',

        a = $(".dt-date");


    if ("laravel" === $("body").attr("data-framework") && (r = $("body").attr("data-asset-path")), e.length) {
        var o = e.DataTable({
            ajax:  path + '/api?date='+ date ,
            columns: [{
                data: "responsive_id"
            }, {
                data: "id"
            }, {
                data: "id"
            }, {
                data: "created_at"
            }, {
                data: "position"
            }, {
                data: "transactions"
            }, {
                data: "screenshot"
            }, {
                data: "nickname"
            }, {
                data: "nickname"
            }],
            columnDefs: [{
                className: "control",
                orderable: !1,
                responsivePriority: 2,
                targets: 0
            }, {
                targets: 1,
                orderable: !1,
                responsivePriority: 3,
                render: function(e, a, t, s) {
                    return '<div class="custom-control custom-checkbox"> <input class="custom-control-input dt-checkboxes" type="checkbox" value="" id="checkbox' + e + '" /><label class="custom-control-label" for="checkbox' + e + '"></label></div>'
                },
                checkboxes: {
                    selectAllRender: '<div class="custom-control custom-checkbox"> <input class="custom-control-input" type="checkbox" value="" id="checkboxSelectAll" /><label class="custom-control-label" for="checkboxSelectAll"></label></div>'
                }
            }, {
                targets: 2,
                visible: !1
            }, {
                responsivePriority: 1,
                targets: 4
            }, {
                targets: 6, visible: !1,
                render: function(a, t, n, s) {
                    var screenshot = n.screenshot;
                    var idt = n.id;

                //   return '<a class="font-weight-bold" href=" '+ screenshot +' ">  '+screenshot+'  </a>'

                //  return '<button class="btn" >Street</button>'


                    return    ''
             //       return    '<button type="button" class="btn btn-primary btn-add-record ml-2" data-toggle="modal" data-target="#exampleModalScrollable'+idt+'"> Visualizza  </button> <div class="modal fade" id="exampleModalScrollable'+idt+'" tabindex="-1" aria-labelledby="exampleModalScrollableTitle" style="display: none;" aria-hidden="true"> <div class="modal-dialog modal-dialog-scrollable" role="document"> <div class="modal-content"> <div class="modal-header"> <h5 class="modal-title" id="exampleModalScrollableTitle'+idt+'">Screenshot</h5> <button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">Ã—</span> </button> </div> <div id ="screenshoot" class="modal-body"> <img width="100%" id ="screenshoot" src="'+screenshot+'" alt=""> </div> <div class="modal-footer"> <button type="button" class="btn btn-primary waves-effect waves-float waves-light" data-dismiss="modal">ok</button> </div> </div> </div></div>'

                }
            }, {
                targets: -1,
                title: "Actions",
                width: "80px",
                orderable: !1,
                render: function(a, t, n, s) {

                    var id = n.id;

                    //   return '<a class="font-weight-bold" href=" '+ screenshot +' ">  '+screenshot+'  </a>'

                    //  return '<button class="btn" >Street</button>'


                    return '<div class="d-flex align-items-center col-actions"><a class="mr-1" href="'+ edit + id +'" data-toggle="tooltip" data-placement="top" title="Send Mail">' + feather.icons.edit.toSvg({
                        class: "font-medium-2"
                    }) + '</a><a class="mr-1" href="' + trash + id + '" data-toggle="tooltip" data-placement="top" title="Preview Invoice">' + feather.icons.trash.toSvg({
                        class: "font-medium-2"
                    }) + '</a></div>'
                }
            }],
            order: [
                [4, "asc"]
            ],
            dom: '<"card-header border-bottom p-1"<"head-label"><"dt-action-buttons text-right"B>><"d-flex justify-content-between align-items-center mx-0 row"<"col-sm-12 col-md-6"l><"col-sm-12 col-md-6"f>>t<"d-flex justify-content-between mx-0 row"<"col-sm-12 col-md-6"i><"col-sm-12 col-md-6"p>>',
            displayLength: 30,
            lengthMenu: [7, 10, 25, 50, 75, 100],
            buttons: [{
                extend: "collection",
                className: "btn btn-outline-secondary dropdown-toggle mr-2",
                text: feather.icons.share.toSvg({
                    class: "font-small-4 mr-50"
                }) + "Export",
                buttons: [{
                    extend: "print",
                    text: feather.icons.printer.toSvg({
                        class: "font-small-4 mr-50"
                    }) + "Print",
                    className: "dropdown-item",
                    exportOptions: {
                        columns: [3, 4, 5, 7]
                    }
                }, {
                    extend: "csv",
                    text: feather.icons["file-text"].toSvg({
                        class: "font-small-4 mr-50"
                    }) + "Csv",
                    className: "dropdown-item",
                    exportOptions: {
                        columns: [3, 4, 5, 7]
                    }
                }, {
                    extend: "excel",
                    text: feather.icons.file.toSvg({
                        class: "font-small-4 mr-50"
                    }) + "Excel",
                    className: "dropdown-item",
                    exportOptions: {
                        columns: [3, 4, 5, 7]
                    }
                }, {
                    extend: "pdf",
                    text: feather.icons.clipboard.toSvg({
                        class: "font-small-4 mr-50"
                    }) + "Pdf",
                    className: "dropdown-item",
                    exportOptions: {
                        columns: [3, 4, 5, 7]
                    }
                }, {
                    extend: "copy",
                    text: feather.icons.copy.toSvg({
                        class: "font-small-4 mr-50"
                    }) + "Copy",
                    className: "dropdown-item",
                    exportOptions: {
                        columns: [3, 4, 5, 7]
                    }
                }],
                init: function(e, a, t) {
                    $(a).removeClass("btn-secondary"), $(a).parent().removeClass("btn-group"), setTimeout((function() {
                        $(a).closest(".dt-buttons").removeClass("btn-group").addClass("d-inline-flex")
                    }), 50)
                },

            },{
                text: "Aggiungi",
                className: "btn btn-primary btn-add-record ml-2",
                action: function(e, a, t) {
                    window.location = n
                }
            }],

            language: {
                paginate: {
                    previous: "&nbsp;",
                    next: "&nbsp;"
                }
            }
        });
        $("div.head-label").html('<h6 class="mb-0">Lista Transazioni</h6>')


    }


    a.length && a.flatpickr({
        enableTime: false,
        monthSelectorType: "static",
        dateFormat: "d/m/Y",
        onChange: function (selectedDates, dateStr, instance) {
            $('#form').submit();
        }
    });




}));

